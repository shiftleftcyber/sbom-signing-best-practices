<?xml version="1.0" encoding="UTF-8"?>
<bom xmlns="http://cyclonedx.org/schema/bom/1.7"
     serialNumber="urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79"
     version="1">
    <metadata>
        <timestamp>2025-01-21T12:00:00Z</timestamp>
        <component type="application" bom-ref="internal-web-app">
            <manufacturer>
                <name>Acme Inc</name>
            </manufacturer>
            <name>Internal Web App</name>
            <version>2.4.1</version>
            <description>This is an example and serves as the affected first-party application in this example.</description>
        </component>
    </metadata>
    <compositions>
        <composition>
            <aggregate>complete</aggregate>
            <vulnerabilities>
                <vulnerability ref="internal-web-app" />
            </vulnerabilities>
        </composition>
    </compositions>
    <vulnerabilities>
        <vulnerability>
            <id>INT-2025-002</id>
            <ratings>
                <rating>
                    <source>
                        <name>Security Research Company</name>
                    </source>
                    <score>6.3</score>
                    <severity>medium</severity>
                    <method>CVSSv31</method>
                    <vector>AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N</vector>
                </rating>
                <rating>
                    <source>
                        <name>Security Research Company</name>
                    </source>
                    <severity>high</severity>
                    <method>OWASP</method>
                    <vector>SL:6/M:1/O:7/S:6/ED:7/EE:5/A:4/ID:8/LC:6/LI:5/LAV:5/LAC:7/FD:7/RD:5/NC:7/PV:9</vector>
                </rating>
            </ratings>
            <cwes>
                <cwe>285</cwe>
            </cwes>
            <description>Authentication bypass vulnerability in the Internal Web App due to improper role validation logic.</description>
            <detail>An authentication bypass vulnerability in the Internal Web App allows users with restricted roles to perform administrative actions. The issue stems from improper role validation in the applicationâ€™s authentication logic, specifically within the 'verifyRole' function. When a crafted HTTP request is sent to endpoints requiring admin privileges, the system incorrectly assigns elevated access to non-admin users. This vulnerability is most impactful in instances where additional access controls are not in place, as it could lead to unauthorized changes to critical system settings, data exposure, and operational disruptions.</detail>
            <recommendation>Update the authentication logic to include strict role validation checks. Deploy version 2.4.2, which addresses the issue by correcting the role validation logic in the 'verifyRole' function.</recommendation>
            <workaround>Restrict access to the application by implementing IP allowlisting or disabling administrative endpoints temporarily.</workaround>
            <proofOfConcept>
                <reproductionSteps>1: Log in with a user account that has restricted privileges (e.g., 'viewer' role). 2: Intercept the authentication token using a proxy tool such as Burp Suite. 3: Modify the HTTP request to include the 'admin=true' parameter in the body or query string. 4: Send the modified request to an administrative endpoint, such as '/admin/settings'. 5: Observe that the response allows unauthorized access to administrative functionality.</reproductionSteps>
                <environment>Prod and subprod</environment>
                <supportingMaterial>
                    <attachment content-type="image/jpeg" encoding="base64">/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3+iiigD//2Q==</attachment>
                </supportingMaterial>
            </proofOfConcept>
            <created>2025-01-19T12:00:00Z</created>
            <published>2025-01-19T12:00:00Z</published>
            <updated>2025-01-21T12:00:00Z</updated>
            <credits>
                <organizations>
                    <organization>
                        <name>Security Research Company</name>
                        <url>https://example.com/</url>
                    </organization>
                </organizations>
                <individuals>
                    <individual>
                        <name>James T. Vidal</name>
                        <email>james.t.vidal@example.com</email>
                    </individual>
                </individuals>
            </credits>
            <analysis>
                <state>exploitable</state>
            </analysis>
            <affects>
                <target>
                    <ref>internal-web-app</ref>
                    <versions>
                        <version>
                            <version>2.4.1</version>
                            <status>affected</status>
                        </version>
                    </versions>
                </target>
            </affects>
        </vulnerability>
    </vulnerabilities>
</bom>
